---

title: "Predictable Voucher Identifier Enumeration in Cibus (Victory Integration)"
slug: "cibus-victory-vouchers-vulnerability"
date: 2026-01-25
description: "Security research analyzing a critical voucher enumeration risk in the Cibus–Victory integration, where pre-allocated, predictable voucher identifiers may be valid prior to end-user issuance."
tags: ["Security Research", "Enumeration", "Weak Identifiers", "Business Logic", "Supply-Chain Risk", "Luhn Algorithm"]
categories: ["Security Research"]
featured_image: "featured.png"
------------------------------

## Executive Summary

This research analyzes a **critical voucher enumeration risk** observed in the integration between **Cibus** and the **Victory** retail chain. Victory vouchers distributed via Cibus were found to rely on **predictable, low-entropy, sequential numeric identifiers** protected only by a Luhn checksum, while being delivered to users through cryptographically secure URLs.

Evidence strongly suggests that Victory vouchers are **generated and pre-allocated by the merchant (Victory)** and provisioned to Cibus in advance. Under this model, vouchers become **valid at the moment of allocation to Cibus**, not when sold to an end user.

If correct, this architecture enables **deterministic theft of unissued vouchers**: future vouchers can be predicted with accuracy and redeemed before legitimate customers ever receive them.

>**Scope Note:**
This research is **strictly limited to Victory-issued vouchers** (prefix `93039000`). Vouchers issued for other merchants (e.g., Shufersal) were observed to follow non-predictable schemes and are out of scope.

---

{{< alert icon="shield" cardColor="#ff48006b" iconColor="#f1faee" >}}

**Severity: CRITICAL (Conditional)**

* **Vulnerability Class:** Predictable Object Identifiers / Business Logic / Supply-Chain Risk
* **Attack Vector:** Offline Enumeration + Opportunistic Physical Redemption
* **Impact:** Deterministic theft of financial assets
* **Risk Threshold:**
    * **CRITICAL (Deterministic):** If vouchers are valid upon allocation, the exploitability is absolute within the pre-allocated pool. An attacker can use a single purchased voucher as an anchor to perform Local Enumeration, discovering valid assets with near-100% certainty. In this state, the only "failures" are collisions with already-redeemed vouchers, but the attacker's "inventory" of valid targets is mathematically guaranteed.
    * **HIGH (Probabilistic):** If vouchers require an "Activation Trigger," the success probability is a function of Temporal Density. The attacker must find identifiers that are both issued (sold) and not yet redeemed. Clustered issuance makes this search space small enough that brute-force redemption remains statistically viable for distributed attacks.
{{< /alert >}}


---

## High-Entropy Delivery Masking Low-Entropy Assets

Cibus delivers vouchers using cryptographically secure, high-entropy URLs. These URLs contain the voucher payload and are intended to prevent unauthorized access.

However, the URL functions only as a **transport wrapper**. The redeemable asset itself—the barcode presented at the point of sale—is a **static numeric identifier** whose structure can be derived offline.

If vouchers were generated dynamically by Cibus, the secure URL would provide little additional security value. The presence of a secure wrapper around a predictable barcode strongly suggests that **voucher secrecy, not generation, is delegated to the URL layer**—a common pattern when assets are pre-generated by an upstream provider.

---

## Observed Voucher Structure (Victory)

Victory vouchers follow a fixed 20-digit numeric structure:

`93039000xxxxxx00400y`

* **Prefix (`93039000`)**: Static, merchant-specific identifier
* **Enumerable Component (`xxxxxx`)**: 6-digit integer, non-random
* **Infix (`00400`)**: Static
* **Checksum (`y`)**: Luhn Mod 10

The checksum enforces syntactic integrity only and provides no resistance against intentional generation.

```python
def calculate_luhn(prefix):
    """Calculates the Luhn Mod 10 check digit for a voucher prefix."""
    digits = [int(d) for d in prefix]
    total_sum = 0
    
    # Iterate backwards; double every second digit
    for i, digit in enumerate(digits[::-1]):
        if i % 2 == 0:
            doubled = digit * 2
            total_sum += doubled - 9 if doubled > 9 else doubled
        else:
            total_sum += digit

    return (10 - (total_sum % 10)) % 10

# Example usage
prefix = "9303900012345600400"
print(f"Checksum: {calculate_luhn(prefix)}") # output: 7
```

---

## Longitudinal Evidence of Merchant-Side Issuance

Voucher identifiers were tracked over approximately **18 months** (June 2024 to January 2026) through repeated legitimate purchases.

Key observations:

* The enumerable component increased from ~360,000 to nearly ~580,000, that is a monthly average of ~12,000 voucher provisioning.
* Growth was **monotonic over long time horizons**
* Identifiers were **not randomly permuted**
* Two vouchers purchased on the same day could appear **out of numerical order**, yet they remain within a narrow enumerable proximity, often showing an observed variance of only a few thousand units.

This behavior is inconsistent with a single, centrally incremented counter and strongly indicative of **pre-allocated identifier pools**. Under this model, Victory provisions batches of vouchers to Cibus, which are later sold to users in non-deterministic order.

This model also explains why vouchers issued for other merchants (e.g., Shufersal) exhibit materially stronger, non-sequential identifiers: voucher generation logic appears to be **merchant-specific**, not platform-wide.

**Evidence of "Restricted Buffers":** If the entire 1,000,000-count keyspace were fully allocated to Cibus, one would expect a uniform, random distribution across the entire range for any given purchase. Instead, observations show that concurrently purchased vouchers are consistently pulled from a narrow "neighborhood" (a few thousand units). This clustering confirms that Cibus is operating from limited, pre-allocated batches provisioned by Victory, rather than having global authority over the identifier space.

---

## Finite Keyspace and Full Predictability

The enumerable component is limited to **6 digits**, yielding a maximum identifier space of **1,000,000 vouchers**.

This creates three critical properties:

1. **Hard Upper Bound**
   A fixed-length enumerable space imposes an unavoidable ceiling. Approaching this bound forces rollover, reuse, or format expansion—each carrying security and operational risk if not explicitly designed.

2. **Complete Predictability**
   Given knowledge of the format and checksum, the entire identifier space—past, present, and future—can be derived offline with trivial effort.

3. **Irreversible Exposure**
   Once identifiers are allocated to Cibus, they cannot be made unpredictable retroactively.

---

## State-Based Threat Model: Why This Becomes Critical

The impact of this issue depends entirely on **when a voucher becomes valid**.

### Voucher States

| State                       | Predictable | Redeemable                             | Risk                    |
| --------------------------- | ----------- | -------------------------------------- | ----------------------- |
| Sold to user                | 100%        | Yes                                    | Theft                   |
| Sold & redeemed             | 100%        | No                                     | Noise                   |
| Allocated to Cibus (unsold) | 100%        | **Yes (if pre-allocated model holds)** | **Deterministic theft** |

Under a pre-allocation model, vouchers are valid **before** being sold to end users. In this case:

* Density is irrelevant
* Guessing is unnecessary
* Attack success rate is **1.0**

An attacker can redeem future vouchers before legitimate customers ever receive them.

---

## Why Traditional Mitigations Do Not Apply

* **Rate Limiting:** Physical retail environments require high transaction throughput. Aggressive limits risk blocking legitimate customers and do not prevent distributed abuse.
* **Sequential Detection:** Sequential voucher usage is common and benign (e.g., group purchases).
* **Physical Presence Assumptions:** Distribution of predicted vouchers across individuals (selling voucher on Telegram, for example) makes abuse indistinguishable from normal consumer behavior.

---

## Architectural Remediation

Because voucher length and numeric format are constrained by legacy POS systems, remediation must focus on **issuance boundaries**, not presentation.

### 1. Eliminate Predictability at the Trust Boundary

Before vouchers become valid, identifiers must be **cryptographically re-mapped** using format-preserving techniques (e.g., Feistel-based permutations). This must be performed by Victory prior to provisioning.

### 2. Enforce Explicit Activation

Vouchers must not be redeemable until explicitly **activated and bound** to a purchasing user. Allocation alone must not confer validity.

### 3. Canary Voucher Detection

Unused portions of the identifier space can be reserved as trap vouchers. Redemption attempts against these identifiers provide high-confidence detection of enumeration activity without impacting legitimate users.

>**The "Pool Window" Blind Spot:**  While Victory can easily detect "Out of Range" attempts (e.g., scanning IDs that haven't been provisioned yet), this provides a false sense of security. An adaptive attacker can "anchor" their search by purchasing a single legitimate voucher to identify the current active pool. By restricting their enumeration to this "local neighborhood" (~12000 voucher window as we estimated before), the attacker bypasses threshold-based alerts and remains indistinguishable from legitimate high-volume traffic.

---

## Conclusion

This issue illustrates a critical failure mode in distributed voucher ecosystems: **predictable assets combined with pre-allocation semantics collapse the security boundary entirely**.

If vouchers are valid at allocation time, security does not degrade gradually—it fails catastrophically. In such systems, secrecy of delivery URLs cannot compensate for predictable identifiers.

Security must be enforced at the **moment of validity**, not at the moment of transport.

**Looking for a research position? [Let's connect on LinkedIn](https://www.linkedin.com/in/rony-utevsky/).**